var sp={statu:{nowPage:"ready"},consts:{pageTransition:200},util:{query:function(e,n){return document["querySelector"+(n?"All":"")](e)},_switchPageTimeOut:null,switchPage:function(e){var n=sp.statu.nowPage,t=sp.consts.pageTransition;e!=n&&($(".page."+n).style.opacity="0",clearTimeout(this._switchPageTimeOut),this._switchPageTimeOut=setTimeout((function(){sp.statu.nowPage=e,$(".page."+n).style.display="none",$(".page."+e).style.display="",setTimeout((function(){$(".page."+e).style.opacity="1"}),10)}),t))}},musiclist:null,infolist:null,mgroups:null,ready:{isReady:!1,setState:function(e,n){var t=$(".page.ready .state");t.innerText=e,t.className="state "+(n||"")},init:function(){$(".page.ready").addEventListener("click",(function(){if(sp.ready.isReady&&(sp.util.switchPage("groups"),localStorage.spNowplay&&localStorage.spMusiclist)){for(var e=parseInt(localStorage.spMusiclist),n=sp.mgroups[e].songs,t=localStorage.spNowplay,i=0;i<n.length;i++)if(n[i].mid==t)return sp.player.nowlistid=e,sp.player.musiclist=n,sp.player.play(i),void($(".playing-mini").style.right="0px");delete localStorage.spMusiclist,delete localStorage.spNowplay}}))}},groups:{init:function(){if(sp.ready.isReady){for(var e=sp.mgroups,n=0;n<e.length;n++){var t=e[n],i=[];t.has&&i.push.apply(i,this.gHas(t.has)),t.mids&&t.mids.forEach((function(e){var n=sp.musiclist.find((function(n){return n.mid==e}));n&&i.push(n)})),t.songs=i}var s=$(".group-list"),a="";e.forEach((function(e,n){a+=`<div class="group-item" data-index="${n}">\n                <div class="imgbox">\n                    <img src="${e.img}" alt="">\n                </div>\n                <div class="info">\n                    <div class="title">${e.name}</div>\n                    <div class="desc">${e.desc}</div>\n                </div>\n            </div>`})),s.innerHTML=a,s.querySelectorAll(".group-item").forEach((function(e,n){e.addEventListener("click",(function(){sp.songs.to(this.dataset.index)}))}))}},gHas:function(e){if(-1!=e.indexOf("*"))return sp.musiclist.filter((function(e){return-1==e.tag.indexOf("Legray")}));var n=[];return e.forEach((function(e){var t=e.split("=")[0],i=e.split("=")[1];if("tag"==t){var s=i.split("&");sp.musiclist.forEach((function(e){var t=!0;s.forEach((function(n){-1==e.tag.indexOf(n)&&(t=!1)})),n.forEach((function(n){n.mid==e.mid&&(t=!1)})),t&&n.push(e)}))}else"matchName"==t?sp.musiclist.forEach((function(e){if(e.name.indexOf(i)>-1){var t=!0;n.forEach((function(n){n.mid==e.mid&&(t=!1)})),t&&n.push(e)}})):"matchArtist"==t&&sp.musiclist.forEach((function(e){if(e.artist.indexOf(i)>-1){var t=!0;n.forEach((function(n){n.mid==e.mid&&(t=!1)})),t&&n.push(e)}}))})),n}},songs:{nowlist:null,nowgroup:null,to:function(e){this.nowlist=e,sp.util.switchPage("songs");var n=this.getGroup(e);$(".page.songs .cover img").src=n.img,$(".page.songs .group-info .name").innerText=n.name,$(".page.songs .group-info .desc").innerText=n.desc,this.drawList(n,e);try{$(".page.songs .active").scrollIntoView({behavior:"smooth",block:"center"})}catch(e){}},getGroup:function(e){return void 0===e&&(e=this.nowlist),JSON.parse(JSON.stringify(sp.mgroups[e]))},drawList:function(e,n){var t="";e.songs=this.sortList(e.songs),this.nowgroup=e,e.songs.forEach((function(e,n){t+=`<div class="item" data-index="${n}" data-mid="${e.mid}">\n                <div class="name">${e.name}</div>\n                <div class="artist">${e.artist}</div>\n            </div>`})),$(".page.songs .list").innerHTML=t,n==sp.player.nowlistid&&this.actItem(sp.player.mid),$(".page.songs .list .item",!0).forEach((function(e){e.addEventListener("click",(function(){sp.player.nowlistid=sp.songs.nowlist,sp.player.musiclist=sp.songs.nowgroup.songs,sp.player.play(parseInt(this.getAttribute("data-index"))),sp.util.switchPage("player"),$(".playing-mini").style.right="","DESTRUCTION 3,2,1"==this.querySelector(".name").innerText.trim()&&sp.player.sp()}))}))},sortList:function(e){var{mode:n,sort:t}=this.getSortMode();return 1==n&&e.sort((function(e,n){return e.name.localeCompare(n.name)})),1==t&&e.reverse(),e},getSortMode:function(){var e=parseInt(localStorage.spSort);e=isNaN(e)?0:e;var n=parseInt(localStorage.spSortMode);return{mode:n=isNaN(n)?0:n,sort:e}},init:function(){$(".page.songs .back").addEventListener("click",(function(){sp.util.switchPage("groups"),sp.songs.nowlist=null,$(".page.songs .list").innerHTML=""}));var{mode:e,sort:n}=this.getSortMode(),t=$(".page.songs .control .sort"),i=$(".page.songs .control .mode");t.innerText=["↓","↑"][n],i.innerText=["默认","字母"][e],t.addEventListener("click",(function(){n=0==n?1:0,t.innerText=["↓","↑"][n],localStorage.spSort=n,sp.songs.drawList(sp.songs.getGroup(),sp.songs.nowlist),sp.player.musiclist=sp.songs.nowgroup.songs,sp.player.nowplay=parseInt($(".page.songs .list .item.active").getAttribute("data-index"))})),i.addEventListener("click",(function(){e=0==e?1:0,i.innerText=["默认","字母"][e],localStorage.spSortMode=e,sp.songs.drawList(sp.songs.getGroup(),sp.songs.nowlist),sp.player.musiclist=sp.songs.nowgroup.songs,sp.player.nowplay=parseInt($(".page.songs .list .item.active").getAttribute("data-index"))}))},actItem:function(e){try{$(".page.songs .list .item",!0).forEach((function(e){e.className="item"})),$('.page.songs .list .item[data-mid="'+e+'"]').className="item active"}catch(e){}}},initer:{initState:0,initMusicList:function(){fetch("/mymusicbox2/musiclist-min.json").then((function(e){return e.json()})).then((function(e){sp.musiclist=e,sp.initer.initState++,sp.initer.finish()})).catch((function(e){sp.ready.setState("加载歌单失败","error")}))},initGroups:function(){fetch("./group-min.json").then((function(e){return e.json()})).then((function(e){sp.mgroups=e,sp.initer.initState++,sp.initer.finish()})).catch((function(e){sp.ready.setState("加载歌单组失败","error")}))},initInfos:function(){fetch("/mymusicbox2/info.json").then((function(e){return e.json()})).then((function(e){sp.infolist=e,sp.initer.initState++,sp.initer.finish()})).catch((function(e){sp.ready.setState("加载歌曲评价失败","error")}))},finish:function(){3==this.initState&&(sp.ready.isReady=!0,sp.ready.setState("点击进入"),sp.groups.init())}},player:{nowlistid:null,config:{INFO:!0,TAG:!0,DEFAULT_MODE:"light",INFO_ROOT:"/mymusicbox2/info/",AUTOPLAY:!0,START_PLAY:"random",PLAY_MODE:"loop",ENABLED_MID:!0,SHOW_MID_IN_URL:!0,PERFORMANCE_MODE:!1,BLURBG:!1,MAINCOLORBG:!0},noticeinter:null,notice:function(e,n=function(){}){clearTimeout(this.noticeinter),document.querySelector(".notice").innerText=e,document.querySelector(".notice").onclick=n,document.querySelector(".notice").style.display="block",this.noticeinter=setTimeout((function(){document.querySelector(".notice").style.display="none",document.querySelector(".notice").onclick=function(){}}),2e3)},colorfulImg:function(e,n){let t=document.createElement("img");function i(){sp.player.rs.push(musicapi._request("https://api.qjqq.cn/api/Imgcolor?img="+e,(function(e){if(e){var t=e.RGB.slice(1),i=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),a=parseInt(t.substring(4,6),16);n("rgba("+i+","+s+","+a+",.5)",(i+s+a)/3>128)}else n("rgba(0,0,0,0)",-1)})))}t.src=e,t.crossOrigin="Anonymous",t.onload=function(){try{let e,i,s,a,r=document.createElement("canvas"),l=r.getContext&&r.getContext("2d"),o=-4,c=50,u=0,p={r:0,g:0,b:0};for(e=r.height=t.height,i=r.width=t.width,l.drawImage(t,0,0),a=l.getImageData(0,0,i,e).data,s=a.length;(o+=4*c)<s;)++u,p.r+=a[o],p.g+=a[o+1],p.b+=a[o+2];p.r=~~(p.r/u),p.g=~~(p.g/u),p.b=~~(p.b/u),n("rgba("+p.r+","+p.g+","+p.b+",.5)",(p.r+p.g+p.b)/3>128)}catch(e){i()}},t.onerror=function(){i()}},formatTime:function(e){var n=Math.floor(e/60),t=Math.floor(e%60);return isNaN(n)?"00:00":(n<10&&(n="0"+n),t<10&&(t="0"+t),n+":"+t)},performanse_test:function(){var e,n=0,t=0;!function(){function s(){requestAnimationFrame((function(){n++,!isStopBlurBg&&s()}))}setTimeout((function(){s(),e=setInterval((function(){n<=16&&++t>5&&(confirm("你的电脑性能较差，是否取消模糊背景功能？")?(clearTimeout(i),localStorage.chaxinneng="yes",document.querySelector(".mbg").style.display="none"):localStorage.chaxinneng="no",isStopBlurBg=!0,clearInterval(e)),n=0}),1e3)}),2e3)}();var i=setTimeout((function(){clearInterval(e),localStorage.chaxinneng="no"}),6e5)},sp:function(){var e=!0;document.body.style.transition="none",document.body.style.cursor="none",setInterval((function(){e=!e,document.querySelector(".siquan-player").style.transform=e?"translateY(-10px)":"translateY(10px)",sp.player.el.mode.click()}),50);var n=!0;setInterval((function(){document.body.style.opacity=Math.random(),n=!n,document.querySelector(".siquan-player").style.transform=n?"translateX(-10px)":"translateX(10px)",sp.player.el.mode.click()}),70)},resize:function(){var e=document.querySelector("#resizer"),n=document.documentElement.clientWidth,t=document.documentElement.clientHeight;if(document.body.style.width=n+"px",document.body.style.height=t+"px",n<700)e.innerHTML="";else{var i=`.siquan-player .container .left .music-album-pic{\nwidth:${Math.min(.287*n,.5*t)}px;\nheight:${Math.min(.287*n,.5*t)}px;\n}\n.siquan-player .container .left .music-info .music-title{\nfont-size:${.02*n}px;\n}\n.iconbtn{\nwidth:${.06*t}px;\nheight:${.06*t}px;\n}\n.siquan-player .container .left .music-info .music-message{\nfont-size:${.012*n}px;\n}\n.siquan-player .container .left .music-controls .range{\nheight:${.0045*t}px;\n}\n.siquan-player .container .left .music-controls .range .r1{\nwidth:${.0105*t}px;\nheight:${.0105*t}px;\ntop:-${.003*t}px;\n}\n.siquan-player .container .left .music-controls .time{\nfont-size:${.012*n}px;\n}\n.siquan-player .container .left .music-controls .pl{\nwidth:${.06*t*3.75+60}px;\nheight:${.06*t*1.25}px;\n}\n.siquan-player .container .left .music-controls .pl .iconbtn{\nwidth:${.06*t*1.25}px;\nheight:${.06*t*1.25}px;\n}\n.siquan-player .container .right ul li{\nfont-size:${.019*n}px;\nline-height:${.038*n}px;\n}\n.siquan-player .container .right ul li.act{\nfont-size:${.034*n}px;\n}\n.dialog .actionbar{\nheight:${.06*t}px;\n}\n.dialog .actionbar .title{\nfont-size:${.025*t}px;\nline-height:${.06*t}px;\n}\n.musiclist.dialog .scroll-con ul li{\nfont-size:${.02*t}px;\nheight:${.045*t}px;\nline-height:${.045*t}px;\n}\n.dialog .scroll-con{\nheight:calc(100% - ${.06*t+1}px);\n}\n.musiclist.dialog .scroll-con  ul li>*{\nheight:${.045*t}px;\n}\n.musiclist.dialog .scroll-con  ul li .index,\n.musiclist.dialog .scroll-con  ul li .anim\n{\nwidth: ${.06*t}px;\n}\n.musiclist.dialog .scroll-con  ul li .name{\nwidth: calc(100% - ${.06*t}px);\n}\n.musiclist.dialog .scroll-con  ul li .anim div{\nheight:${.015*t}px;\nwidth:${.045*t*.05}px;\n}\n.musiclist.dialog .scroll-con  ul li .anim div:nth-child(1){\nleft:${.06*t*.375}px;\n}\n.musiclist.dialog .scroll-con  ul li .anim div:nth-child(2){\nleft:${.06*t*.525}px;\n}\n.musiclist.dialog .scroll-con  ul li .anim div:nth-child(3){\nleft:${.06*t*.675}px;\n}\n.musicinfo.dialog .d-c{\nfont-size:${.024*t}px;\n}\n.s-tag{\nfont-size:${.024*t*.75}px;\n}`;e.innerHTML=i}},rs:[],nowplay:-1,mid:null,musiclist:null,init:function(){var e=window.document,n=$(".page.player");function t(e){sp.player.rs.forEach((function(e){e.abort()})),sp.player.nowplay=e,sp.player.mid=sp.player.musiclist[e].mid,a.img.src=g,$(".playing-mini img").src=g,a.title.innerText=a.album.innerText=a.info.title.innerText=a.info.album.innerText=a.info.pj.innerText=a.info.singer.innerText=a.singer.innerText="...",a.audio.src="",p={0:"正在加载"},sp.songs.actItem(sp.player.mid),i(),function(e){e>=0&&(a.title.innerText=a.info.title.innerText=sp.player.musiclist[e].name,n.title=c=sp.player.musiclist[e].name,a.singer.innerText=a.info.singer.innerText=sp.player.musiclist[e].artist);sp.player.rs.push(musicapi.get(-1==e?lssong:sp.player.musiclist[e],(function(e){e.error?(sp.player.notice("歌曲获取失败",(function(){alert(e.error)})),a.nextbtn.click()):(a.img.src=e.img,n.querySelector(".mbg img").src=e.img,$(".playing-mini img").src=e.img,a.title.innerText=a.info.title.innerText=e.songname,n.title=c=e.songname,a.audio.src=e.url,a.album.innerText=a.info.album.innerText=e.album,a.singer.innerText=a.info.singer.innerText=e.artist,p=e.lrc,i(),f.MAINCOLORBG&&!f.BLURBG&&sp.player.colorfulImg(e.minipic||e.img,(function(e,t){n.querySelector(".siquan-player").style.background=e,-1!=t&&(t&&0==s||!t&&1==s)&&a.mode.click()})))})))}(e),function(e){f.TAG&&(a.info.tags.innerHTML=sp.player.musiclist[e].tag.map((function(e){return'<span class="s-tag">'+e+"</span>"})).join(""));if(-1==e||!f.INFO||!f.ENABLED_MID)return;a.info.pj.innerText=sp.infolist[sp.player.musiclist[e].mid]||"暂无"}(e),localStorage.spNowplay=sp.player.musiclist[e].mid,localStorage.spMusiclist=sp.player.nowlistid}function i(){for(var e in a.lrc.innerHTML="",p){var t=n.createElement("li");t.innerText=p[e],a.lrc.append(t)}}n.getElementById=function(n){return e.getElementById(n)},n.body=e.body,n.documentElement=e.documentElement,n.head=e.head,n.createElement=function(n){return e.createElement(n)},Object.defineProperty(n,"title",{get:function(){return e.title},set:function(n){e.title=n}}),this.play=t;var s,a,r,l,o,c="我的音乐盒子",u=!1,p={0:"歌词加载中"},g="https://image.gumengya.cn/i/2023/10/15/652b46cf15392.png",d=!1,m=!0,f=sp.player.config;a={img:n.getElementById("img"),title:n.getElementById("music-title"),album:n.getElementById("music-album"),singer:n.getElementById("music-singer"),audio:n.getElementById("audio"),range:{r1:n.querySelector(".range .r1"),r2:n.querySelector(".range .r2"),r:n.querySelector(".range")},time:{cur:n.querySelector(".time .l"),max:n.querySelector(".time .r")},playbtn:n.querySelector(".playbtn"),container:n.querySelector(".siquan-player .container"),lrc:n.querySelector(".right ul"),lastbtn:n.querySelector(".lastbtn"),nextbtn:n.querySelector(".nextbtn"),switchBtn:n.querySelector(".sx"),fullBtn:n.querySelector(".full"),mode:n.querySelector(".mode"),musiclistbtn:n.getElementById("siquan-player-musiclist"),musicinfobtn:n.getElementById("siquan-player-musicinfo"),info:{title:n.querySelector(".info-name"),album:n.querySelector(".info-album"),singer:n.querySelector(".info-singer"),tags:n.querySelector(".info-tags .in"),pj:n.querySelector(".info-pj .in"),tags_f:n.querySelector(".info-tags"),pj_f:n.querySelector(".info-pj")}},sp.player.el=a,window.addEventListener("resize",sp.player.resize),sp.player.resize(),f.AUTOPLAY&&a.audio.addEventListener("canplay",(function(){try{this.play()}catch(e){}})),a.audio.addEventListener("timeupdate",(function(){if(!d){var e=a.audio.currentTime,t=a.audio.duration,i=e/t;m&&(a.range.r2.style.width=100*i+"%",a.range.r1.style.left="calc("+100*i+"% - 6px)"),a.time.cur.innerText=sp.player.formatTime(e),a.time.max.innerText=sp.player.formatTime(t);var s=-1;for(var r in p){if(e<r)break;s++}try{a.lrc.querySelector("li.act").classList.remove("act")}catch(e){}for(var l=n.querySelector(".right").getBoundingClientRect().height/2,o=a.lrc.querySelectorAll("li"),c=0;c<s;c++)l-=o[c].getBoundingClientRect().height;-1!=s&&(l-=o[s].getBoundingClientRect().height/2,a.lrc.querySelectorAll("li")[s].classList.add("act")),a.lrc.style.marginTop=l+"px"}})),a.audio.addEventListener("play",(function(){a.container.classList.add("playing"),$(".playing-mini .img").classList.add("playing"),a.playbtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause" viewBox="0 0 16 16">  <path d="M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5m4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5"/></svg>'})),a.audio.addEventListener("pause",(function(){a.container.classList.remove("playing"),$(".playing-mini .img").classList.remove("playing"),a.playbtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">  <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/></svg>'})),a.audio.addEventListener("ended",(function(){1==r?(this.currentTime=0,this.play()):a.nextbtn.click()})),function(){a.img.onerror=$(".playing-mini img").onerror=function(){this.src=g},a.playbtn.addEventListener("click",(function(){a.container.classList.contains("playing")?a.audio.pause():a.audio.play()})),r=["order","loop","random"].indexOf(f.PLAY_MODE);var e=['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-repeat" viewBox="0 0 16 16"><path d="M11 5.466V4H5a4 4 0 0 0-3.584 5.777.5.5 0 1 1-.896.446A5 5 0 0 1 5 3h6V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192Zm3.81.086a.5.5 0 0 1 .67.225A5 5 0 0 1 11 13H5v1.466a.25.25 0 0 1-.41.192l-2.36-1.966a.25.25 0 0 1 0-.384l2.36-1.966a.25.25 0 0 1 .41.192V12h6a4 4 0 0 0 3.585-5.777.5.5 0 0 1 .225-.67Z"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-repeat-1" viewBox="0 0 16 16"><path d="M11 4v1.466a.25.25 0 0 0 .41.192l2.36-1.966a.25.25 0 0 0 0-.384l-2.36-1.966a.25.25 0 0 0-.41.192V3H5a5 5 0 0 0-4.48 7.223.5.5 0 0 0 .896-.446A4 4 0 0 1 5 4zm4.48 1.777a.5.5 0 0 0-.896.446A4 4 0 0 1 11 12H5.001v-1.466a.25.25 0 0 0-.41-.192l-2.36 1.966a.25.25 0 0 0 0 .384l2.36 1.966a.25.25 0 0 0 .41-.192V13h6a5 5 0 0 0 4.48-7.223Z"/><path d="M9 5.5a.5.5 0 0 0-.854-.354l-1.75 1.75a.5.5 0 1 0 .708.708L8 6.707V10.5a.5.5 0 0 0 1 0z"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shuffle" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.624 9.624 0 0 0 7.556 8a9.624 9.624 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.595 10.595 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.624 9.624 0 0 0 6.444 8a9.624 9.624 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5"/><path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192zm0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192z"/></svg>'];a.switchBtn.innerHTML=e[r],a.nextbtn.addEventListener("click",(function(){-1!=sp.player.nowplay&&(2==r?t(Math.floor(Math.random()*sp.player.musiclist.length)):sp.player.nowplay==sp.player.musiclist.length-1?t(0):t(sp.player.nowplay+1))})),a.lastbtn.addEventListener("click",(function(){-1!=sp.player.nowplay&&(2==r?t(Math.floor(Math.random()*sp.player.musiclist.length)):0==sp.player.nowplay?t(sp.player.musiclist.length-1):t(sp.player.nowplay-1))})),a.switchBtn.addEventListener("click",(function(){2==r?r=0:r++,this.innerHTML=e[r]}))}(),a.range.r1.addEventListener("mousedown",(function(){var e;m=!1,n.onmousemove=function(n){var t=n.pageX,i=a.range.r.getBoundingClientRect().width,s=t-a.range.r.getBoundingClientRect().left;s<0&&(s=0),s>i&&(s=i),e=s/i,a.range.r2.style.width=100*e+"%",a.range.r1.style.left="calc("+100*e+"% - 6px)"},n.onmouseup=function(){n.onmousemove=null,n.onmouseup=null,m=!0,a.audio.currentTime=a.audio.duration*e}})),a.range.r1.addEventListener("touchstart",(function(){var e;function t(n){var t=n.targetTouches[0].pageX,i=a.range.r.getBoundingClientRect().width,s=t-a.range.r.getBoundingClientRect().left;s<0&&(s=0),s>i&&(s=i),e=s/i,a.range.r2.style.width=100*e+"%",a.range.r1.style.left="calc("+100*e+"% - 6px)"}m=!1,n.addEventListener("touchmove",t,{passive:!1}),n.addEventListener("touchend",(function i(){n.removeEventListener("touchmove",t),n.removeEventListener("touchend",i),m=!0,a.audio.currentTime=a.audio.duration*e}),{passive:!1})}),{passive:!1}),a.range.r.addEventListener("click",(function(e){if(m){var n=(e.pageX-a.range.r.getBoundingClientRect().left)/a.range.r.getBoundingClientRect().width;a.audio.currentTime=a.audio.duration*n}})),l=['<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-moon-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/></svg>'],s=(o=["dark","light"]).indexOf(f.DEFAULT_MODE),n.body.classList.add(f.DEFAULT_MODE),a.mode.innerHTML=l[s],a.mode.addEventListener("click",(function(){n.body.classList.remove(o[s]),s=1==s?0:1,this.innerHTML=l[s],n.body.classList.add(o[s])})),a.musiclistbtn.addEventListener("click",(function(){if($(".playing-mini").style.right="0",null!=sp.songs.nowlist){sp.util.switchPage("songs");try{$(".page.songs .active").scrollIntoView({behavior:"smooth",block:"center"})}catch(e){}}else sp.util.switchPage("groups")})),a.musicinfobtn.addEventListener("click",(function(){n.querySelector(".dialog.musicinfo").classList.add("show")})),a.fullBtn.addEventListener("click",(function(){e.fullscreenElement?e.exitFullscreen():n.documentElement.requestFullscreen()})),e.addEventListener("fullscreenchange",(function(){e.fullscreenElement?(a.fullBtn.querySelector(".full").style.display="block",a.fullBtn.querySelector(".unfull").style.display="none"):(a.fullBtn.querySelector(".unfull").style.display="block",a.fullBtn.querySelector(".full").style.display="none")})),n.querySelectorAll(".dialog .close").forEach((function(e){e.addEventListener("click",(function(){this.parentElement.parentElement.parentElement.parentElement.classList.remove("show")}))})),n.addEventListener("keydown",(function(e){" "==e.key?a.playbtn.click():"ArrowLeft"==e.key?a.lastbtn.click():"ArrowRight"==e.key&&a.nextbtn.click()})),f.PERFORMANCE_MODE&&(n.addEventListener("visibilitychange",(function(){var e=n.hidden;n.body.style.display=e?"none":""})),window.onfocus=function(){f.BLURBG&&!u&&(clearInterval(xinnenginter),checkxinnengInterval()),n.title=c,a.img.style.animationPlayState="",n.querySelector(".playing-anim").style.display="",d=!1},window.onblur=function(){f.BLURBG&&!u&&clearInterval(xinnenginter),n.title="[性能模式冻结中]"+c,a.img.style.animationPlayState="paused",n.querySelector(".playing-anim").style.display="none",d=!0}),f.TAG||(a.info.tags_f.style.display="none"),f.INFO||(a.info.pj_f.style.display="none"),f.BLURBG&&"yes"!=localStorage.chaxinneng&&(n.querySelector(".mbg").style.display="block",localStorage.chaxinneng||sp.player.performanse_test())}},init:function(){sp.ready.setState("正在加载歌单...","loading"),this.ready.init(),this.initer.initMusicList(),this.initer.initInfos(),this.initer.initGroups(),this.songs.init(),this.player.init(),$(".playing-mini").addEventListener("click",(function(){sp.util.switchPage("player"),this.style.right=""}))}},$=sp.util.query;sp.init();